# NEUROBACK: IMPROVING CDCL SAT SOLVING USING GRAPH NEURAL NETWORKS  

Wenxi Wang, Yang Hu, Mohit Tiwari, Sarfraz Khurshid, Ken McMillan, Risto Miikkulainen The University of Texas at Austin Austin, TX 78712, USA wenxiw@utexas.edu, huyang@utexas.edu, tiwari@austin.utexas.edu, khurshid@utexas.edu, kenmcm@cs.utexas.edu, risto@cs.utexas.edu  

## ABSTRACT  

Propositional satisfiability (SAT) is an NP- complete problem that impacts many research fields, such as planning, verification, and security. Mainstream modern SAT solvers are based on the Conflict- Driven Clause Learning (CDCL) algorithm. Recent work aimed to enhance CDCL SAT solvers using Graph Neural Networks (GNNs). However, so far this approach either has not made solving more effective, or required substantial GPU resources for frequent online model inferences. Aiming to make GNN improvements practical, this paper proposes an approach called NeuroBack, which builds on two insights: (1) predicting phases (i.e., values) of variables appearing in the majority (or even all) of the satisfying assignments are essential for CDCL SAT solving, and (2) it is sufficient to query the neural model only once for the predictions before the SAT solving starts. Once trained, the offline model inference allows NeuroBack to execute exclusively on the CPU, removing its reliance on GPU resources. To train NeuroBack, a new dataset called DataBack containing 120,286 data samples is created. NeuroBack is implemented as an enhancement to a state- of- the- art SAT solver called Kissat. As a result, it allowed Kissat to solve up to \(5.2\%\) and \(7.4\%\) more problems on two recent SAT competition problem sets, SATCOMP- 2022 and SATCOMP- 2023, respectively. NeuroBack therefore shows how machine learning can be harnessed to improve SAT solving in an effective and practical manner.  

## 1 INTRODUCTION  

Propositional satisfiability (SAT) solvers are designed to check the satisfiability of a given propositional logic formula. SAT solvers have advanced significantly in recent years, which has fueled their applications in a wide range of domains. Mainstream modern SAT solvers are based on the CDCL algorithm Marques- Silva & Sakallah (2003). It mainly relies on two kinds of variable related heuristics: 1) the variable branching heuristic Moskewicz et al. (2001); Liang et al. (2016), for deciding which variables are the best to branch on; 2) the phase selection heuristic Pipatsrisawat & Darwiche (2007); Biere & Fleury (2020); Fleury & Heisinger (2020), for deciding which phase (i.e., value) a variable should have.  

Recently, Graph Neural Networks (GNNs) have been proposed to improve CDCL SAT solvers by enhancing these two heuristics. However, this approach has not usually made solvers more effective Jaszczur et al. (2020); Kurin et al. (2019); Han (2020). One exception is NeuroCore Selsam & Bj√∏rner (2019) which aims to improve the variable branching heuristic in CDCL SAT solvers by predicting the variables involved in the unsatisfiable (unsat) core (i.e., a subset of the SAT formula that remains unsat). It performs frequent online model inferences to adjust its unsat core prediction with dynamic information extracted from the SAT solving process. As a result, NeuroCore helps two classic CDCL SAT solvers called MiniSat and Glucose solve more problems in the main track of SATCOMP- 2018 Heule et al. (2018).  

However, frequent online inferences cause NeuroCore computationally intensive during its application. The demand on GPU resources escalate, especially when deployed in parallel, a prevalent way for utilizing SAT solvers to tackle complex problems Hamadi et al. (2010); Schreiber & Sanders (2021); Martins et al. (2012). Obviously, lacking GPU resources would become the major bottleneck of NeuroCore's parallel performance. Note that, the setup of NeuroCore's experiments called for network access to 20 GPUs distributed over five machines to support 400 parallel NeuroCore runs.