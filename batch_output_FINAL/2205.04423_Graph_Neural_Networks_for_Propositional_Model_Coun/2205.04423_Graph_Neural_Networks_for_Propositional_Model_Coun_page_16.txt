27. Velickovic, P., Cucurull, G., Casanova, A., Romero, A., Liò, P., Bengio, Y.: Graph attention networks. In: 6th International Conference on Learning Representations, ICLR 2018, Vancouver, BC, Canada, April 30 - May 3, 2018, Conference Track Proceedings. OpenReview.net (2018), https://openreview.net/forum?id=rJXMpikCZ28. Wang, J., Yin, M., Wu, J.: Two approximate algorithms for model counting. Theor. Comput. Sci. 657, 28-37 (2017). https://doi.org/10.1016/j.tcs.2016.04.047, https://doi.org/10.1016/j.tcs.2016.04.0429. Wei, W., Selman, B.: A new approach to model counting. In: Bacchus, F., Walsh, T. (eds.) Theory and Applications of Satisfiability Testing, 8th International Conference, SAT 2005, St. Andrews, UK, June 19-23, 2005, Proceedings. Lecture Notes in Computer Science, vol. 3569, pp. 324-339. Springer (2005). https://doi.org/10.1007/11499107_24, https://doi.org/10.1007/11499107_2430. Yolcu, E., Póczos, B.: Learning local search heuristics for boolean satisfiability. In: Wallach, H.M., Larochelle, H., Beygelzimer, A., d'Alché-Buc, F., Fox, E.B., Garnett, R. (eds.) Advances in Neural Information Processing Systems 32: Annual Conference on Neural Information Processing Systems 2019, NeurIPS 2019, December 8-14, 2019, Vancouver, BC, Canada. pp. 7990-8001 (2019), https://proceedings.neurips.cc/paper/2019/hash/12e59a33dea1bf0630f46edfe13d6ea2-Abstract.html  

## A Extended Background  

## A.1 Factor Graphs and Belief Propagation  

Belief Propagation (BP) [20] is an approximate inference algorithm that leverages the factor graph arising from its input probability distribution in its computational scheme. Given a probability distribution such as the one of Equation 1, the corresponding factor graph is a bipartite graph in which nodes are partitioned into factor nodes \(F = \{f_{1},\ldots ,f_{m}\}\) (representing the factors of the probability distribution) and variable nodes \(V = \{x_{1},\ldots ,x_{n}\}\) (representing the variables of the probability distribution). There is an undirected edge between a variable node \(x_{i}\in V\) and a factor node \(f_{j}\in F\) if and only if \(f_{j}\) depends on \(x_{i}\) . Using this formalism, the neighbors \(\mathcal{N}(f_{j})\) of a factor node \(f_{j}\in F\) are exactly all the variables appearing in \(f_{j}\) , and the neighbors \(\mathcal{N}(x_{i})\) of a variable node \(x_{i}\in V\) are exactly all the factors that depend on that variable.  

Each node passes messages to its neighbors, so that variables send messages to factor nodes, and viceversa factors send messages to variable nodes, using the the iterative rules detailed in Equation 2.  

It is possible to prove that BP is exact on tree factor graphs (i.e. it returns an exact solution in time linear in the number of variables \(n\) ), however it can be very effective also on loopy graphs. When applied to graphs with loops, it is called Loopy Belief Propagation (LBP).  

After \(T\) iterations of message passing (Equation 2), variables' beliefs (i.e. approximate marginals) \(\{b_{i}(x_{i})\}_{i = 1}^{n}\) are computed as:  

\[\begin{array}{c}{b_{i}(x_{i}) = \frac{1}{Z_{i}}\prod_{f_{j}\in \mathcal{N}(x_{i})}m_{j\to i}^{(T)}(x_{i})}\\ {Z_{i} = \sum_{x_{i}}\prod_{f_{j}\in \mathcal{N}(x_{i})}m_{j\to i}^{(T)}(x_{j})} \end{array} \quad (13)\]