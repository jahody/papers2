# Can Graph Neural Networks Learn to Solve MaxSAT Problem?  

Minghao Liu \(^{1,3}\) , Fuqi Jia \(^{1,3}\) , Pei Huang \(^{1,3}\) , Fan Zhang \(^{5}\) , Yuchen Sun \(^{4}\) , Shaowei Cai \(^{1,3}\) , Feifei Ma \(^{1,2,3}\) , Jian Zhang \(^{1,3}\)  

\(^{1}\) State Key Laboratory of Computer Science, Institute of Software, Chinese Academy of Sciences \(^{2}\) Laboratory of Parallel Software and Computational Science, Institute of Software, Chinese Academy of Sciences \(^{3}\) University of Chinese Academy of Sciences \(^{4}\) Inspir.ai \(^{5}\) Individual researcher Beijing, China {liumh, maff}@ios.ac.cn  

## Abstract  

With the rapid development of deep learning techniques, various recent work has tried to apply graph neural networks (GNNs) to solve NP- hard problems such as Boolean Satisfiability (SAT), which shows the potential in bridging the gap between machine learning and symbolic reasoning. However, the quality of solutions predicted by GNNs has not been well investigated in the literature. In this paper, we study the capability of GNNs in learning to solve Maximum Satisfiability (MaxSAT) problem, both from theoretical and practical perspectives. We build two kinds of GNN models to learn the solution of MaxSAT instances from benchmarks, and show that GNNs have attractive potential to solve MaxSAT problem through experimental evaluation. We also present a theoretical explanation of the effect that GNNs can learn to solve MaxSAT problem to some extent for the first time, based on the algorithmic alignment theory.  

## Introduction  

The propositional logic has long been recognized as one of the corner stones of reasoning in philosophy and mathematics (Biere et al. 2009). The satisfiability problem of propositional logic formulas (SAT) has significant impact on many areas of computer science and artificial intelligence. SAT is the first problem proved to be NP- complete (Cook 1971), requiring the worst- case exponential time to be solved unless \(\mathrm{P} = \mathrm{NP}\) . The Maximum Satisfiability problem (MaxSAT) is a generalization of SAT, which aims to optimize the number of satisfied clauses, and it is also an NP- hard problem with a wide range of applications (Ansótegui, Bonet, and Levy 2013). There have been tremendous efforts in solving SAT and MaxSAT efficiently, and numerous solvers have been developed in the last few decades such as (Cai and Zhang 2021). Nevertheless, these off- the- shelf solvers are mainly based on search algorithms with elaborate handcrafted strategies. Thanks to recent advances in deep representation learning, particularly for non- euclidean structure, there have been initial efforts to represent and solve combinatorial problems such as SAT through data- driven approaches. It relies on the fact that the distribution of problem instances in practice is generally domain- specific, which means that we can solely replace the training data to obtain efficient implicit heuristics instead of carefully modifying the strategies for certain domain.   

The current application of deep learning to SAT problem can be grouped into two categories. One is to build an end- to- end model that inputs a problem instance and directly predicts the satisfiability or solution, as demonstrated in Figure 1. A pioneering work is NeuroSAT (Selsam et al. 2019), which shows that graph neural networks (GNNs) have capability to learn the satisfiability of SAT instances in specific domain (i.e., whether a group of assignments to the variables exists such that all the clauses are satisfied). (Cameron et al. 2020) further explores the performance of GNN models on predicting the satisfiability of random 3SAT problems which are still challenging for the state- of- the- art solvers. The other category combines neural networks with the traditional search frameworks, trying to improve the effects of some key heuristics. For example, GNNs are used to replace the variable selection function in the WalkSAT solver (Yolcu and Póczos 2019), produce the initialization assignment of local search (Zhang et al. 2020), or guide the search by predicting the variables in the unsat core (Selsam and Bjørner 2019). These efforts indicate that GNN models are believed to have a certain degree of capability for learning from SAT problem instances, and also the potential to help improve SAT solving techniques in the future.  

Nevertheless, the current research barely discusses the quality of solution predicted by the models, which should be an important indicator to check what GNNs learn from SAT problems. The end- to- end models mentioned above mainly focus on the prediction of satisfiability. For a satisfiable instance, the predicted solution given by models is infeasible most of the time, and we also have no idea how far it is from a feasible solution. In order to better understand the capability of GNN models, we target the subject as learning the solution of MaxSAT problem, an optimization version of SAT which aims at finding a solution that maximizes the number of satisfied clauses. The advantage is that as an optimization problem, we can analyze the quality of solution in more detail, such as the number of satisfied clauses and the approximation ratio, while a solution of SAT provides little information that it is valid or not. It is worth mentioning that although the 2SAT problem (i.e., each clause contains two